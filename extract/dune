(coq.extraction
 (prelude Extract)
 (extracted_modules 
  BinNums BinPos Datatypes Specif  List0 String0
  base Basics BinInt zmap pmap fin_maps numbers option decidable
  ErrorMonad CoqUtil CoqBigInt Loc StateMonad
  Extmap Extset Wstdlib Weakhtbl CoqHashtbl Hashcons Number Ctr
  IntFuncs 
  IdentDefs
  TyDefs TyFuncs)
 (theories Src stdpp Proofs ExtLib)
 )

;create Ident.ml
 (rule
  (deps IdentDefs.ml IdentExtra.ml)
  (targets Ident.ml)
  (action 
  (with-stdout-to Ident.ml
    (pipe-stdout
     (cat IdentDefs.ml IdentExtra.ml)
     (run sed -e "s/open IdentDefs//g")
    )
   )
  )
 )

;Create Ty.ml by concatenation Defs, Exn, Funcs
 (rule
  (deps TyDefs.ml TyExn.ml TyFuncs.ml TyExtra.ml)
  (targets Ty.ml)
  (action 
  (with-stdout-to Ty.ml
    (pipe-stdout
     (cat TyDefs.ml TyExn.ml TyFuncs.ml TyExtra.ml)
     (run sed -e "s/open TyDefs//g")
     (run sed -e "s/open IdentDefs/open Ident/g")
    )
   )
  )
 )

(library
 (name Why3Coq)
 (modules (:standard \ TyExn TyDefs TyFuncs TyExtra IdentDefs IdentExtra))
 (flags (:standard -w -33 -w -32)) ;32 is unused value - extraction results in values we don't want in mli file
 (libraries zarith))


